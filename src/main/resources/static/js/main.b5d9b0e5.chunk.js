(this["webpackJsonpiron-safe-ui"]=this["webpackJsonpiron-safe-ui"]||[]).push([[0],{29:function(e,t,n){e.exports=n(40)},34:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(18),c=n.n(i),s=n(4),l=n(16),o=(n(34),n(3)),u=n(15),d=function(e){return{type:"UPDATE_USER",user:e}},h=function(e){return{type:"UPDATE_TOKEN",token:e}},p=function(e){return{type:"UPDATE_MESSAGE",message:e}},m=function(e){return{type:"ADD_CREDENTIALS",credentials:e}},f=function(e){return{type:"LOGGED_IN",loggedIn:e}},g=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGGED_IN":return t.loggedIn;default:return e}},E=n(28),v=function(e){return!!(e&&e.length>0)&&!e[0].hasOwnProperty("key")},b=function(e){return v(e)?e.map((function(e){var t=e.split(".");return{key:t[0],value:t[1]}})):e},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_CREDENTIALS":return b(t.credentials);case"ADD_CREDENTIAL":return console.log("Adding the following credential + ".concat(t.credential)),[].concat(Object(E.a)(e),[t.credential]);case"REMOVE_CREDENTIAL":return console.log("Removing the following credential + ".concat(t.credential)),e.filter((function(e){return e!==t.credential}));case"REMOVE_CREDENTIALS":return console.log("Removing all credentials"),[];default:return e}},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_MESSAGE":return t.message;default:return e}},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_USER":return t.user;default:return e}},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_TOKEN":return t.token;default:return e}},j=Object(u.c)({user:O,loggedIn:g,credentials:C,genericMessage:y,token:w}),S=n(2),N=function e(){Object(S.a)(this,e)};N.isCredentialValid=function(e){var t=e.trim();return!N.hasEmptySpaces(t)&&!N.isEmpty(t)&&!N.moreThan15Characters(t)},N.hasEmptySpaces=function(e){return e.includes(" ")},N.isEmpty=function(e){return""===e},N.moreThan15Characters=function(e){return e.length>15};var k=function(e){return function(e){return function(t){switch(t.type){case"ADD_CREDENTIAL_DATA_BASE":N.isCredentialValid(t.credential.value)&&N.isCredentialValid(t.credential.key)?(n=t.credential,a=P.getState().token,fetch("/safe/add/credential",{method:"post",body:JSON.stringify(n),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(a)}})).then((function(e){return e.json()})).then((function(e){e?(P.dispatch(p("Credential was added")),P.dispatch(function(e){return{type:"ADD_CREDENTIAL",credential:e}}(t.credential))):P.dispatch(p("Credential was not added"))})).catch((function(e){console.log(e),P.dispatch(p("Something went wrong"))})):P.dispatch(p("Credentials were invalid \n Credentials must not contain empty spaces \n Credentials must not exceed more than 15 characters"));break;default:e(t)}var n,a}}},I=function(e){return function(e){return function(t){switch(t.type){case"REMOVE_CREDENTIAL_DATA_BASE":(n=t.credential,a=P.getState().token,fetch("/safe/remove/credential",{method:"delete",body:JSON.stringify(n),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(a)}})).then((function(e){return e.json()})).then((function(e){e?(P.dispatch(p("Credential was removed")),P.dispatch(function(e){return{type:"REMOVE_CREDENTIAL",credential:e}}(t.credential))):P.dispatch(p("Credential was not removed"))})).catch((function(e){console.log(e),P.dispatch(p("Something went wrong"))}));break;default:e(t)}var n,a}}},A=function(e){var t=e.email,n=e.password;return t.includes(".")&&t.includes("@")&&n.length>=5},D=function e(){Object(S.a)(this,e),this.unsubscribeListener=null};D.storeUserData=function(e){sessionStorage.setItem("Iron-Safe",JSON.stringify(e))},D.doesUserDataExist=function(){return sessionStorage.getItem("Iron-Safe")},D.getUserData=function(){return JSON.parse(sessionStorage.getItem("Iron-Safe"))},D.removeUserData=function(){D.unsubscribeListener(),sessionStorage.removeItem("Iron-Safe")},D.updateSession=function(){D.unsubscribeListener=P.subscribe((function(){sessionStorage.setItem("Iron-Safe",JSON.stringify(P.getState()))}))},D.restoreSession=function(){if(D.doesUserDataExist()){D.unsubscribeListener||D.updateSession();var e=D.getUserData();P.dispatch(h(e.token)),P.dispatch(d(e.user)),P.dispatch(m(e.credentials)),P.dispatch(f(!0)),P.dispatch(p(null))}};var T=D,L=function(e){return function(e){return function(t){switch(t.type){case"LOGIN":A(t.credential)?(n=t.credential,fetch("/user/authenticate",{method:"post",body:JSON.stringify(n),headers:{Accept:"application/json","Content-Type":"application/json"}})).then((function(e){return e.json()})).then((function(e){e.status&&202!==e.status?P.dispatch(p("Something wrong happened")):(T.updateSession(),P.dispatch(h(e.jwt)),P.dispatch(d(e.safe.email)),P.dispatch(m(e.safe.credentials)),P.dispatch(f(!0)),P.dispatch(p(null)))})).catch((function(e){console.log(e.message),P.dispatch(p("Something wrong happened"))})):P.dispatch(p("Credentials are not valid"));break;default:e(t)}var n}}},_=function(e){var t=e.email,n=e.confirmEmail,a=e.password,r=e.confirmPassword;return t.includes(".")&&t.includes("@")&&n.includes(".")&&n.includes("@")&&a.length>=5&&r.length>=5},R=function(e){return function(e){return function(t){switch(t.type){case"REGISTER":_(t.credential)?(n=t.credential,fetch("/user/create",{method:"post",body:JSON.stringify(n),headers:{Accept:"text/html","Content-Type":"application/json"}})).then((function(e){return e.text()})).then((function(e){return P.dispatch(p(e))})).catch((function(e){console.log(e),P.dispatch(p(e))})):P.dispatch(p("Credentials are not valid"));break;default:e(t)}var n}}},U=function(e){return function(e){return function(t){switch(t.type){case"LOGOUT":P.dispatch(f(!1)),P.dispatch(h(null)),P.dispatch(d(null)),P.dispatch(p(null)),P.dispatch({type:"REMOVE_CREDENTIALS"}),T.removeUserData();break;default:e(t)}}}},M=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||u.d,P=Object(u.e)(j,M(Object(u.a)(k,I,L,R,U))),x=n(5),V=n(7),G=n(6),B=n(8),J=function(e){var t=e.handleChange,n=e.label,a=e.type,i=e.value;return r.a.createElement("div",null,r.a.createElement("input",{className:"textInputs",type:a,onChange:t,name:n.replace(" ","").toLowerCase(),value:i,placeholder:a}))},z=function(){P.dispatch(p(null))},K=function(e){function t(e){var n;return Object(S.a)(this,t),(n=Object(V.a)(this,Object(G.a)(t).call(this,e))).handleChange=function(e){var t={};t[e.target.name]=e.target.value,n.setState(t)},n.onClick=function(e){var t=n.state,a={email:t.email,password:t.password};n.props.attemptLogin(a),n.setState({password:""})},n.state={email:"",password:""},z(),n}return Object(B.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){var e=this.state,t=e.email,n=e.password,a=this.props.loggedIn;return r.a.createElement("div",null,a?r.a.createElement(l.a,{push:!0,to:"/credentials"}):r.a.createElement("div",{className:"loginPanel"},r.a.createElement("h1",{className:"panel-title"},"Login"),r.a.createElement(J,{handleChange:this.handleChange,value:t,label:"Email",type:"email"}),r.a.createElement(J,{handleChange:this.handleChange,value:n,label:"Password",type:"password"}),r.a.createElement("input",{className:"formBtn",type:"submit",onClick:this.onClick,value:"Login"}),r.a.createElement(s.b,{className:"links",to:"/register"},"Register")))}}]),t}(r.a.Component),X=Object(o.b)((function(e){return{activeView:e.activeView,loggedIn:e.loggedIn}}),(function(e){return{attemptLogin:function(t){e(function(e){return{type:"LOGIN",credential:e}}(t))}}}))(K),W=function(e){function t(e){var n;return Object(S.a)(this,t),(n=Object(V.a)(this,Object(G.a)(t).call(this,e))).handleChange=function(e){var t={};t[e.target.name]=e.target.value,n.setState(t)},n.onClick=function(e){var t=n.state,a={email:t.email,confirmEmail:t.confirmemail,password:t.password,confirmPassword:t.confirmpassword};n.props.attemptRegistration(a),n.setState({password:"",confirmpassword:""})},n.state={email:"",confirmemail:"",password:"",confirmpassword:""},z(),n}return Object(B.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){var e=this.state,t=e.email,n=e.confirmemail,a=e.password,i=e.confirmpassword;return r.a.createElement("div",null,r.a.createElement("div",{className:"registrationPanel"},r.a.createElement("h1",{className:"panel-title"},"Registration"),r.a.createElement(J,{handleChange:this.handleChange,label:"Email",value:t,type:"email"}),r.a.createElement(J,{handleChange:this.handleChange,label:"Confirm Email",value:n,type:"email"}),r.a.createElement(J,{handleChange:this.handleChange,label:"Password",value:a,type:"password"}),r.a.createElement(J,{handleChange:this.handleChange,label:"Confirm Password",value:i,type:"password"}),r.a.createElement("input",{className:"formBtn",type:"submit",onClick:this.onClick,value:"Register"}),r.a.createElement(s.b,{className:"links",to:"/login"},"Login")))}}]),t}(a.Component),q=Object(o.b)((function(e){return{}}),(function(e){return{attemptRegistration:function(t){e(function(e){return{type:"REGISTER",credential:e}}(t))}}}))(W),F=function(e){function t(e){var n;return Object(S.a)(this,t),(n=Object(V.a)(this,Object(G.a)(t).call(this,e))).removeCurrentCredential=function(e){n.props.removeCredential(n.credential)},n.onClick=function(e){n.setState({show:!n.state.show})},n.credential=e.credential,n.state={show:!1},n}return Object(B.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){var e=this.state.show;return r.a.createElement("li",{className:"credentialListItem"},r.a.createElement("div",{onClick:this.onClick,className:"key"},this.credential.key),r.a.createElement("div",{className:"value "+(e?"show":"hide")},this.credential.value),r.a.createElement("div",{onClick:this.removeCurrentCredential,className:"remove "+(e?"show":"hide")},"REMOVE"))}}]),t}(r.a.Component),H=Object(o.b)((function(e){return{message:e.genericMessage,loggedIn:e.loggedIn}}),(function(e){return{removeCredential:function(t){e(function(e){return{type:"REMOVE_CREDENTIAL_DATA_BASE",credential:e}}(t))}}}))(F),Q=function(e){function t(){var e,n;Object(S.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(V.a)(this,(e=Object(G.a)(t)).call.apply(e,[this].concat(r)))).logout=function(e){n.props.attemptLogout()},n}return Object(B.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){var e=this.props,t=e.credentials,n=e.user,a=e.loggedIn;return r.a.createElement("div",null,a?r.a.createElement("div",{className:"lobbyPanel"},r.a.createElement("h1",{className:"welcome-message"},"Welcome ",n," "),r.a.createElement("h1",{className:"panel-title"},"Credentials"),r.a.createElement("ul",{className:"credential-list"},t&&t.map((function(e,t){return r.a.createElement(H,{key:e.key,credential:e})}))),r.a.createElement(s.b,{className:"linkButton",to:"/add-credential"},"Add Credential")):r.a.createElement(l.a,{push:!0,to:"/"}))}}]),t}(r.a.Component),Y=Object(o.b)((function(e){return{credentials:e.credentials,user:e.user,activeView:e.activeView,loggedIn:e.loggedIn}}),(function(e){return{attemptLogout:function(){e({type:"LOGOUT"})}}}))(Q),Z=function(e){function t(e){var n;return Object(S.a)(this,t),(n=Object(V.a)(this,Object(G.a)(t).call(this,e))).handleChange=function(e){var t={};t[e.target.name]=e.target.value,n.setState(t)},n.onClick=function(e){var t=n.state,a={key:t.key,value:t.value};n.props.addCredential(a),n.setState({key:"",value:""})},n.state={key:"",value:""},z(),n}return Object(B.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){var e=this.props.loggedIn;return r.a.createElement("div",null,e?r.a.createElement("div",{className:"createPanel"},r.a.createElement("h1",{className:"panel-title"},"Create Credential"),r.a.createElement("input",{className:"textInputs",type:"text",name:"key",value:this.state.key,onChange:this.handleChange,placeholder:"key"}),r.a.createElement("input",{className:"textInputs",type:"text",name:"value",value:this.state.value,onChange:this.handleChange,placeholder:"value"}),r.a.createElement("br",null),r.a.createElement("input",{className:"formBtn",type:"submit",value:"Add",onClick:this.onClick}),r.a.createElement(s.b,{className:"links",to:"/credentials"},"Lobby")):r.a.createElement(l.a,{push:!0,to:"/"}))}}]),t}(r.a.Component),$=Object(o.b)((function(e){return{message:e.genericMessage,loggedIn:e.loggedIn}}),(function(e){return{addCredential:function(t){e(function(e){return{type:"ADD_CREDENTIAL_DATA_BASE",credential:e}}(t))}}}))(Z),ee=function(e){function t(){return Object(S.a)(this,t),Object(V.a)(this,Object(G.a)(t).apply(this,arguments))}return Object(B.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"generalMessageModal "+(this.props.message?"show":"hide")},this.props.message&&r.a.createElement("div",null,r.a.createElement("p",null,this.props.message),r.a.createElement("button",{onClick:this.props.resetMessage},"Ok")))}}]),t}(a.Component),te=Object(o.b)((function(e){return{message:e.genericMessage}}),(function(e){return{resetMessage:function(){e(p(null))}}}))(ee),ne=function(e){function t(){var e,n;Object(S.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(V.a)(this,(e=Object(G.a)(t)).call.apply(e,[this].concat(r)))).logOut=function(){n.props.attemptLogout()},n}return Object(B.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){var e=this.props.loggedIn;return r.a.createElement("div",{className:"navbar"},r.a.createElement(s.b,{className:"nav-item",to:"/lobby"},"Iron-Safe"),e&&r.a.createElement("p",{onClick:this.logOut,className:"logout-nav nav-item"},"logout"))}}]),t}(a.Component),ae=Object(o.b)((function(e){return{loggedIn:e.loggedIn}}),(function(e){return{attemptLogout:function(){e({type:"LOGOUT"})}}}))(ne);c.a.render(r.a.createElement((function(e){var t=e.store;return r.a.createElement(o.a,{store:t},T.restoreSession(),r.a.createElement(te,null),r.a.createElement(s.a,null,r.a.createElement(ae,null),r.a.createElement(l.d,null,r.a.createElement(l.b,{exact:!0,path:["/","/login"],component:X}),r.a.createElement(l.b,{exact:!0,path:"/register",component:q}),r.a.createElement(l.b,{exact:!0,path:"/add-credential",component:$}),r.a.createElement(l.b,{exact:!0,path:"/credentials",component:Y}),r.a.createElement(l.a,{to:"/"}))))}),{store:P}),document.getElementById("root"))}},[[29,1,2]]]);
//# sourceMappingURL=main.b5d9b0e5.chunk.js.map